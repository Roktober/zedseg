# zedseg
## Get started
### Запуск видео  
Командная строка cmd: e:\igor\src\zedseg  
Чтобы обработать видео запускаем python process_svo.py sar-21:44-1 (в папке Игорь папака svo папка sar – видеозаписи из Сарапулки)  
Можно указать вместо sar-21:44-1 указать путь к файлу e:\igor\sar\rec2018_07_21-16.svo
### Запустить создание и наложение маски
Добавляем маску -m  
python process_svo.py –m   
unet512-2 sar-21:44-1
#### Чтобы наложить на видео
Добавляем параметр -v  
python process_svo.py -m unet512-2  -v sar-21:44-1
### Чтобы сохранить файл
python process_svo.py –m unet512-2 e:\igor\sar\rec2018_07_21-16.svo 16-1.mp4  
Тогда создаст и сохранит в файл 16-1.mp4  
По умолчанию используется левый глаз камеры. 
### Какие есть параметры
python process_svo.py -h  
Получаем список параметров:
- e – склеить видео в одну картинку
- f – уменьшить видео
- r – на правый глаз камеры
- p – параметры для кодирования видео
### Чтобы запустить на другом компьютере нужно
1)	Установить программа NVidia Cuda (чтобы поддерживала видеокарата)
2)	Склонировать репозиторий на гитхабе либо тупо скопировать папку (но она много вестит)
3)	Поставить зависимости (pytorch.org)
4)	Список зависимостей:
Torch
Albumentations
Ffmpeg-python
h5py
Opencv-python
Opencv-contrib-python
Pywin32
5)	Поставить zed sdk и скомпилировать по инструкции на сайте zed-pyton-api (найти в интернете)
### Как мы работаем с обучением?
Python train.py либо python service.py – можем запустить его как сервис и он появится в Мой компьютер – Управление компьютером – Службы – Train Zed segmentation
Будет работать в соответствии с конфигурацией config.json  
Делаем:  
python service.py start 
### На чем он обучается?
3 источника, run.bat, одновременно система все использует
1)	Png-изображение: берет файлы из папки images full-in и full-out или part
2)	h5 – самый простой способ был создания обучающей выборки, на видео обводили квадратиками и говорил, что это такой класс
3)	cvat (есть инструкция у Алексея Евгеньевича) – тут можно обводить объекты. Это хорошая работа для студентов!  
Логин: user  
Пароль: aaa  
Можно с помощью process.svo сделать mp4 из svo и загрузить для разметки.  
Результаты либо сохраняем на сервере.  
Чтобы загрузить – down annotation. Кладем в папку cvat, преобразовываем в формат h5 командой cvat и система создает обучающей выборкой  
Есть картинки на разметку: sar-120-I – размечать кадры на видео
## Структура проекта
### service.py
Запуск 'train.py' как службы windows
### train.py

